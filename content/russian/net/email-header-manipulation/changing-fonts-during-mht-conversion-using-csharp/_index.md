---
title: Изменение шрифтов во время преобразования MHT с использованием C#
linktitle: Изменение шрифтов во время преобразования MHT с использованием C#
second_title: Aspose.Email .NET API обработки электронной почты
description: Узнайте, как изменить шрифты во время преобразования MHT с помощью Aspose.Email для .NET. Пошаговое руководство с исходным кодом. Идеально подходит для архивирования электронной почты и управления документами.
type: docs
weight: 11
url: /ru/net/email-header-manipulation/changing-fonts-during-mht-conversion-using-csharp/
---

Вы когда-нибудь сталкивались с необходимостью преобразовать сообщение электронной почты в формат MHT с сохранением стилей шрифта? Это руководство проведет вас через процесс изменения шрифтов во время преобразования MHT с использованием мощной библиотеки Aspose.Email для .NET. Независимо от того, работаете ли вы над архивированием электронной почты, управлением документами или любым другим проектом, включающим преобразование электронной почты, это пошаговое руководство поможет вам легко достичь своей цели.

## Введение в преобразование MHT и Aspose.Email для .NET

### Что такое МХТ?

MHT (MIME HTML) — это формат файла, который позволяет сохранить веб-страницу, включая все ее ресурсы, в одном документе. Его часто используют для архивирования веб-страниц и сообщений электронной почты, поскольку он сохраняет структуру и внешний вид исходного контента.

### О Aspose.Email для .NET

Aspose.Email для .NET — это надежная библиотека, предоставляющая функциональные возможности для работы с форматами электронной почты, включая загрузку, анализ и преобразование электронных писем. Это идеальный выбор для разработчиков, которым необходимо эффективно решать различные задачи, связанные с электронной почтой.

## Настройка вашего проекта

### Установка Aspose.Email для .NET

 Для начала вам необходимо установить библиотеку Aspose.Email for .NET. Вы можете скачать его с сайта[Aspose.Релизы](https://releases.aspose.com/email/net) или используйте диспетчер пакетов NuGet в Visual Studio.

### Создание нового проекта .NET

1. Откройте Visual Studio и создайте новый проект .NET.
2. Установите библиотеку Aspose.Email для .NET с помощью диспетчера пакетов NuGet.
3. Теперь вы готовы начать программировать!

## Загрузка и анализ сообщения электронной почты

### Загрузка сообщения электронной почты

Прежде чем мы сможем изменить шрифты в электронном письме, нам нужно загрузить сообщение электронной почты. Вы можете загрузить электронное письмо из различных источников, таких как файл, поток или даже почтовый сервер.

```csharp
// Загрузите сообщение электронной почты
var message = MailMessage.Load("sample.eml");
```

### Анализ тела сообщения

После загрузки электронного письма вы можете получить доступ к его различным частям, включая тело HTML. Анализ тела HTML позволяет нам вносить изменения в шрифт.

```csharp
// Разобрать тело HTML
var htmlBody = message.HtmlBody;
```

## Изменение шрифтов в электронном письме

### Понимание стилей шрифтов

Шрифты в электронных письмах HTML определяются с использованием стилей CSS. Чтобы изменить шрифты, вам необходимо изменить стили CSS, связанные с HTML-содержимым электронного письма.

### Программное изменение шрифтов

Допустим, вы хотите изменить шрифт абзаца в HTML-теле письма. Вот как вы можете это сделать:

```csharp
// Изменить шрифт абзаца
htmlBody = htmlBody.Replace("<p>", "<p style=\"font-family: Arial;\">");
```

## Преобразование в формат MHT

### Создание сообщения MHT

Чтобы преобразовать электронное письмо в формат MHT, вам необходимо создать сообщение электронной почты в формате MHT с помощью Aspose.Email.

```csharp
// Создать сообщение электронной почты в формате MHT.
var mhtMessage = MhtMessage.FromMailMessage(message);
```

### Сохранение сообщения в формате MHT

Наконец, сохраните сообщение в формате MHT в файл.

```csharp
// Сохраните сообщение в формате MHT.
mhtMessage.Save("output.mht", SaveOptions.DefaultMhtml);
```

## Полный исходный код

Вот полный исходный код, который объединяет все:

```csharp
using Aspose.Email;
using Aspose.Email.Mime;
using Aspose.Email.Mhtml;

class Program
{
    static void Main()
    {
        var message = MailMessage.Load("sample.eml");
        var htmlBody = message.HtmlBody;
        htmlBody = htmlBody.Replace("<p>", "<p style=\"font-family: Arial;\">");

        var mhtMessage = MhtMessage.FromMailMessage(message);
        mhtMessage.Save("output.mht", SaveOptions.DefaultMhtml);
    }
}
```

## Заключение

В этом руководстве мы рассмотрели, как изменить шрифты во время преобразования MHT с помощью Aspose.Email для .NET. Выполнив эти шаги, вы сможете легко конвертировать сообщения электронной почты в формат MHT, сохраняя при этом нужные стили шрифтов.


## Часто задаваемые вопросы


### Могу ли я преобразовать несколько писем в формат MHT за один раз?

Да, вы можете просмотреть коллекцию сообщений электронной почты и применить одни и те же изменения шрифта к каждому сообщению перед преобразованием их в формат MHT.

### Поддерживает ли Aspose.Email другие форматы электронной почты?

Да, Aspose.Email поддерживает различные форматы электронной почты, включая EML, MSG, PST и другие.

### Можно ли дополнительно настроить изменения шрифта?

Абсолютно! Вы можете изучить дополнительные стили CSS для настройки шрифтов, таких как размер, цвет и выравнивание шрифта.

### Могу ли я использовать Aspose.Email для коммерческих проектов?

Да, Aspose.Email можно использовать как для личных, так и для коммерческих проектов в соответствии с условиями лицензии.

 Помните, что в этом руководстве представлен общий обзор, и вы можете изучить его дальше, обратившись к[Справочник по API Aspose.Email](https://reference.aspose.com/email/net/)и опробовать различные методы настройки шрифтов. Приятного кодирования!