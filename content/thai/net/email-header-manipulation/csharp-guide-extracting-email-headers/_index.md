---
title: คู่มือ C# - แยกส่วนหัวอีเมล
linktitle: คู่มือ C# - แยกส่วนหัวอีเมล
second_title: Aspose.Email .NET API การประมวลผลอีเมล
description: เรียนรู้วิธีแยกส่วนหัวอีเมลใน C# โดยใช้ Aspose.Email สำหรับ .NET คำแนะนำทีละขั้นตอนพร้อมซอร์สโค้ดเพื่อการวิเคราะห์อีเมลที่มีประสิทธิภาพ
type: docs
weight: 15
url: /th/net/email-header-manipulation/csharp-guide-extracting-email-headers/
---

คุณเคยสงสัยหรือไม่ว่าจะแยกส่วนหัวของอีเมลโดยใช้ C# ได้อย่างไร? ส่วนหัวของอีเมลประกอบด้วยข้อมูลอันมีค่าเกี่ยวกับผู้ส่ง ผู้รับ หัวเรื่อง และรายละเอียดอื่นๆ มากมาย ในคู่มือนี้ เราจะแนะนำคุณตลอดกระบวนการแยกส่วนหัวอีเมลแบบทีละขั้นตอนโดยใช้ไลบรารี Aspose.Email สำหรับ .NET อันทรงพลัง ไลบรารีนี้มีชุดคุณลักษณะที่ครอบคลุมสำหรับการทำงานกับอีเมลในแอปพลิเคชัน .NET ของคุณ

## รู้เบื้องต้นเกี่ยวกับส่วนหัวของอีเมล

ส่วนหัวของอีเมลเป็นองค์ประกอบสำคัญของข้อความอีเมลที่ให้ข้อมูลเมตาเกี่ยวกับข้อความนั้น รวมถึงข้อมูลต่างๆ เช่น ที่อยู่อีเมลของผู้ส่ง ที่อยู่อีเมลของผู้รับ เรื่อง วันที่ และอื่นๆ การแยกส่วนหัวอีเมลมีประโยชน์สำหรับวัตถุประสงค์ต่างๆ รวมถึงการวิเคราะห์ความถูกต้องของอีเมล การติดตามเส้นทางของอีเมล และการจัดหมวดหมู่ข้อความ

## เริ่มต้นใช้งาน Aspose.Email สำหรับ .NET

Aspose.Email สำหรับ .NET เป็นไลบรารีอเนกประสงค์ที่ช่วยให้นักพัฒนา .NET สามารถทำงานกับอีเมลได้อย่างราบรื่น โดยนำเสนอคุณสมบัติที่หลากหลายสำหรับการสร้าง จัดการ และแยกข้อมูลจากข้อความอีเมล ในการเริ่มต้น ให้ทำตามขั้นตอนเหล่านี้:

### การติดตั้ง Aspose.Email ผ่าน NuGet

หากต้องการรวม Aspose.Email ในโปรเจ็กต์ของคุณ คุณต้องติดตั้งแพ็คเกจ Aspose.Email NuGet เปิดคอนโซลตัวจัดการแพ็คเกจของคุณและรันคำสั่งต่อไปนี้:

```csharp
Install-Package Aspose.Email
```

### กำลังโหลดข้อความอีเมล

เมื่อคุณเพิ่มไลบรารี Aspose.Email ลงในโปรเจ็กต์ของคุณแล้ว คุณสามารถเริ่มโหลดข้อความอีเมลได้ ไลบรารีรองรับรูปแบบอีเมลต่าง ๆ เช่น EML และ MSG ต่อไปนี้คือวิธีการโหลดข้อความอีเมล:

```csharp
using Aspose.Email;


// โหลดข้อความอีเมล
var message = MailMessage.Load("path/to/email.eml");
```

### การเข้าถึงส่วนหัวของอีเมล

 การเข้าถึงส่วนหัวของอีเมลโดยใช้ Aspose.Email นั้นตรงไปตรงมา ส่วนหัวของอีเมลจะแสดงเป็นชุดของคู่คีย์-ค่า คุณสามารถเข้าถึงได้โดยใช้`Headers` ทรัพย์สินของ`MailMessage` วัตถุ:

```csharp
// เข้าถึงส่วนหัวของอีเมล
foreach (var header in message.Headers)
{
    Console.WriteLine($"{header.Key}: {header.Value}");
}
```

## การแยกข้อมูลส่วนหัวเฉพาะ

แม้ว่าส่วนหัวของอีเมลจะมีรายละเอียดที่หลากหลาย แต่คุณอาจสนใจที่จะดึงข้อมูลเฉพาะออกมา เรามาสำรวจวิธีการแยกส่วนหัวที่ใช้กันทั่วไป:

### จากและไปยังส่วนหัว

ส่วนหัว "จาก" แสดงถึงที่อยู่อีเมลของผู้ส่ง ในขณะที่ส่วนหัว "ถึง" ประกอบด้วยที่อยู่ของผู้รับ คุณสามารถแยกมันออกมาได้ดังนี้:

```csharp
string from = message.Headers["From"];
string to = message.Headers["To"];
```

### หัวเรื่อง

ส่วนหัวของหัวเรื่องถือเป็นเรื่องของอีเมล แยกมันโดยใช้:

```csharp
string subject = message.Headers["Subject"];
```

### ส่วนหัวของวันที่

ส่วนหัวของวันที่ระบุว่าส่งอีเมลเมื่อใด แตกออกมาดังนี้:

```csharp
string date = message.Headers["Date"];
```

## การจัดการกับสถานการณ์ที่ซับซ้อน

ในบางกรณี อีเมลอาจมีหลายส่วนหัวหรือส่วนหัวที่มีโครงสร้างที่ซับซ้อน ไลบรารี Aspose.Email ช่วยให้การจัดการสถานการณ์ดังกล่าวง่ายขึ้น:

### ส่วนหัวอีเมลหลายรายการ

อีเมลอาจมีส่วนหัวเดียวกันหลายอินสแตนซ์ หากต้องการดึงข้อมูลส่วนหัว "รับ" ทั้งหมด เช่น:

```csharp
var receivedHeaders = message.Headers.GetValues("Received");
```

### เวอร์ชัน MIME และส่วนหัวประเภทเนื้อหา

ส่วนหัว "MIME-Version" และ "Content-Type" มีความสำคัญอย่างยิ่งต่อการแสดงเนื้อหาอีเมล เข้าถึงได้ดังนี้:

```csharp
string mimeVersion = message.Headers["MIME-Version"];
string contentType = message.Headers["Content-Type"];
```

## การใช้ข้อมูลส่วนหัวที่แยกออกมา

เมื่อคุณดึงข้อมูลส่วนหัวออกมาแล้ว คุณสามารถนำไปใช้ให้เกิดประโยชน์ได้:

### การบันทึกข้อมูลส่วนหัว

คุณสามารถบันทึกรายละเอียดส่วนหัวที่แยกออกมาเพื่อวัตถุประสงค์ในการวิเคราะห์หรือแก้ไขข้อบกพร่องได้:

```csharp
foreach (var header in message.Headers)
{
    Console.WriteLine($"{header.Key}: {header.Value}");
}
```

### การวิเคราะห์ส่วนหัวแบบกำหนดเอง

คุณสามารถดำเนินการวิเคราะห์ส่วนหัวแบบกำหนดเองได้ เช่น การจัดหมวดหมู่อีเมลตามส่วนหัวเฉพาะ:

```csharp
if (subject.Contains("urgent"))
{
    Console.WriteLine("This email is marked as urgent.");
}
```

## บทสรุป

การแยกส่วนหัวอีเมลเป็นทักษะที่มีคุณค่าในการทำงานกับอีเมลโดยทางโปรแกรม Aspose.Email สำหรับ .NET ช่วยให้กระบวนการนี้ง่ายขึ้นและมีชุดเครื่องมือที่มีประสิทธิภาพสำหรับการจัดการข้อความอีเมลอย่างมีประสิทธิภาพ ด้วยการทำตามขั้นตอนที่ระบุไว้ในคู่มือนี้ คุณสามารถแยกและใช้ข้อมูลส่วนหัวของอีเมลในแอปพลิเคชัน C# ของคุณได้อย่างมั่นใจ

## คำถามที่พบบ่อย

### ฉันจะติดตั้ง Aspose.Email สำหรับ .NET ได้อย่างไร

หากต้องการติดตั้ง Aspose.Email ผ่าน NuGet ให้ใช้คำสั่งต่อไปนี้:
```csharp
Install-Package Aspose.Email
```

### ฉันสามารถแยกส่วนหัวเดียวกันหลายอินสแตนซ์ออกจากอีเมลได้หรือไม่

ใช่ คุณสามารถแยกส่วนหัวเดียวกันได้หลายอินสแตนซ์โดยใช้`GetValues` วิธี:
```csharp
var receivedHeaders = message.Headers.GetValues("Received");
```

### ส่วนหัวทั่วไปที่ควรแยกออกจากอีเมลมีอะไรบ้าง

ส่วนหัวที่แยกออกมาโดยทั่วไป ได้แก่ "จาก" "ถึง" "หัวเรื่อง" และ "วันที่"

### ฉันจะจัดหมวดหมู่อีเมลตามส่วนหัวที่ต้องการได้อย่างไร

คุณสามารถวิเคราะห์ข้อมูลส่วนหัวได้โดยใช้คำสั่งแบบมีเงื่อนไข ตัวอย่างเช่น หากต้องการจัดหมวดหมู่อีเมลเร่งด่วน:
```csharp
if (subject.Contains("urgent"))
{
    Console.WriteLine("This email is marked as urgent.");
}
```

### ฉันจะเข้าถึงเอกสาร Aspose.Email และดาวน์โหลดไลบรารีได้ที่ไหน

 คุณสามารถค้นหาเอกสารได้ที่[https://reference.aspose.com/email/net/](https://reference.aspose.com/email/net/) . ดาวน์โหลดห้องสมุดได้ที่[https://releases.aspose.com/email/net/](https://releases.aspose.com/email/net/).