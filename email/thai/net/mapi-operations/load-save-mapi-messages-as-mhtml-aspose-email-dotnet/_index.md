---
"date": "2025-05-30"
"description": "เรียนรู้วิธีการโหลดข้อความ MAPI จากไฟล์ด้วยโปรแกรมและแปลงเป็นรูปแบบ MHT โดยใช้ Aspose.Email สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนนี้"
"title": "วิธีการโหลดและบันทึกข้อความ MAPI เป็น MHTML โดยใช้ Aspose.Email สำหรับ .NET"
"url": "/th/net/mapi-operations/load-save-mapi-messages-as-mhtml-aspose-email-dotnet/"
"weight": 1
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}
# วิธีการโหลดและบันทึกข้อความ MAPI เป็น MHTML โดยใช้ Aspose.Email สำหรับ .NET

## การแนะนำ
การจัดการข้อความอีเมลด้วยโปรแกรมอาจเป็นเรื่องท้าทาย โดยเฉพาะกับรูปแบบที่ซับซ้อน เช่น MAPI อย่างไรก็ตาม ด้วย Aspose.Email สำหรับ .NET คุณสามารถโหลดข้อความเหล่านี้จากไฟล์และบันทึกเป็นรูปแบบ MHT (MIME HTML) ที่ใช้งานบนเว็บได้อย่างง่ายดาย

คู่มือนี้จะแนะนำคุณเกี่ยวกับการใช้ Aspose.Email สำหรับ .NET เพื่อแปลงข้อความ MAPI เป็นรูปแบบ MHTML คุณจะได้เรียนรู้วิธีการกำหนดค่าตัวเลือกการบันทึกและดำเนินการกับไฟล์อย่างมีประสิทธิภาพ

**สิ่งที่คุณจะได้เรียนรู้:**
- การตั้งค่า Aspose.Email สำหรับ .NET ในสภาพแวดล้อมการพัฒนาของคุณ
- การโหลดข้อความ MAPI โดยใช้ `MapiMessage` ระดับ.
- การกำหนดค่าเทมเพลต HTML แบบกำหนดเองเพื่อบันทึกในรูปแบบ MHT
- บันทึกข้อความ MAPI เป็นไฟล์ MHTML พร้อมตัวเลือกที่กำหนดเอง

## ข้อกำหนดเบื้องต้น

### ไลบรารี เวอร์ชัน และการอ้างอิงที่จำเป็น
หากต้องการทำตามบทช่วยสอนนี้ คุณจะต้องมี:
- **Aspose.Email สำหรับ .NET**: ตรวจสอบให้แน่ใจว่าคุณติดตั้งเวอร์ชัน 22.10 หรือใหม่กว่า
- **.NET Framework หรือ .NET Core/5+/6+**: ขึ้นอยู่กับการตั้งค่าโครงการของคุณ

### ข้อกำหนดการตั้งค่าสภาพแวดล้อม
ตรวจสอบให้แน่ใจว่าสภาพแวดล้อมการพัฒนาของคุณรองรับโครงการ .NET คุณสามารถใช้ Visual Studio, VS Code ที่มีนามสกุล C# หรือ IDE ใดๆ ที่รองรับการพัฒนา .NET

### ข้อกำหนดเบื้องต้นของความรู้
ความเข้าใจพื้นฐานเกี่ยวกับ:
- การเขียนโปรแกรม C#
- การจัดการไฟล์และไดเร็กทอรีใน .NET
- การทำงานกับไลบรารีของบุคคลที่สาม

## การตั้งค่า Aspose.Email สำหรับ .NET
การเริ่มต้นใช้งาน Aspose.Email นั้นง่ายมาก ดังต่อไปนี้คือวิธีติดตั้ง:

**การใช้ .NET CLI:**
```bash
dotnet add package Aspose.Email
```

**การใช้คอนโซลตัวจัดการแพ็คเกจ:**
```powershell
Install-Package Aspose.Email
```

**การใช้ UI ของตัวจัดการแพ็คเกจ NuGet:**
1. เปิดตัวจัดการแพ็กเกจ NuGet
2. ค้นหา "Aspose.Email" และติดตั้งเวอร์ชันล่าสุด

### การขอใบอนุญาต
ในการเริ่มใช้ Aspose.Email คุณสามารถทำได้ดังนี้:
- **ทดลองใช้งานฟรี**ดาวน์โหลดใบอนุญาตทดลองใช้เพื่อทดสอบคุณสมบัติทั้งหมด
- **ใบอนุญาตชั่วคราว**:รับใบอนุญาตชั่วคราวเพื่อเข้าถึงคุณลักษณะเต็มรูปแบบโดยไม่มีข้อจำกัดในการประเมิน
- **ซื้อ**:ซื้อการสมัครสมาชิกหากคุณพร้อมที่จะรวมเข้าในสภาพแวดล้อมการผลิตของคุณ

เมื่อติดตั้งแล้ว ให้เริ่มต้นไลบรารีโดยรวมเนมสเปซที่จำเป็นในโครงการของคุณ:
```csharp
using Aspose.Email;
using System;
```

## คู่มือการใช้งาน

### คุณสมบัติ 1: โหลดข้อความ MAPI จากไฟล์

#### ภาพรวม
ฟีเจอร์นี้สาธิตวิธีโหลดข้อความ MAPI จากเส้นทางไฟล์ที่ระบุโดยใช้ Aspose.Email ซึ่งมีความสำคัญต่อการประมวลผลอีเมลที่จัดเก็บเป็นข้อความ MAPI

#### ขั้นตอนการดำเนินการ
**ขั้นตอนที่ 1**: กำหนดเส้นทางไดเร็กทอรี
แทนที่ `"YOUR_DOCUMENT_DIRECTORY"` ด้วยไดเร็กทอรีจริงของคุณที่ `MapiTask.msg` ไฟล์อยู่
```csharp
string dataDir = "YOUR_DOCUMENT_DIRECTORY"; // แทนที่ด้วยเส้นทางไดเร็กทอรีเอกสารของคุณ
```
**ขั้นตอนที่ 2**:โหลดข้อความ MAPI
ใช้ `MapiMessage.FromFile()` วิธีการโหลดข้อความโดยสร้าง `MapiMessage` คัดค้านจากมัน
```csharp
// โหลด MapiMessage จากไฟล์ที่ระบุ
dynamic msg = MapiMessage.FromFile(dataDir + "MapiTask.msg");
```

### คุณสมบัติ 2: กำหนดค่าตัวเลือกการบันทึก MHT

#### ภาพรวม
การกำหนดค่าตัวเลือกการบันทึกช่วยให้คุณกำหนดวิธีการบันทึกข้อความ MAPI ในรูปแบบ MHTML ได้เอง ขั้นตอนนี้เกี่ยวข้องกับการตั้งค่าเทมเพลตและตัวเลือกรูปแบบ

#### ขั้นตอนการดำเนินการ
**ขั้นตอนที่ 1**: เริ่มต้น `MhtSaveOptions`
ตั้งค่าตัวเลือกการบันทึก MHTML เริ่มต้น ซึ่งจะถูกปรับเปลี่ยนสำหรับเอาท์พุตแบบกำหนดเอง
```csharp
dynamic opt = SaveOptions.DefaultMhtml;
```
**ขั้นตอนที่ 2**: ตั้งค่าตัวเลือกการจัดรูปแบบ
เปิดใช้งานการแสดงผลฟิลด์งานและข้อมูลส่วนหัวในไฟล์ MHTML ที่คุณบันทึกไว้
```csharp
opt.MhtFormatOptions = MhtFormatOptions.RenderTaskFields | MhtFormatOptions.WriteHeader;
```
**ขั้นตอนที่ 3**: ปรับแต่งเทมเพลต
กำหนดเทมเพลต HTML สำหรับคุณสมบัติงานต่าง ๆ เพื่อควบคุมลักษณะที่ปรากฏในไฟล์เอาต์พุต
```csharp
// ล้างเทมเพลตที่มีอยู่
opt.FormatTemplates.Clear();

// เพิ่มเทมเพลต HTML ที่กำหนดเองสำหรับคุณสมบัติงานที่เฉพาะเจาะจง
opt.FormatTemplates.Add(MhtTemplateName.Task.Subject, "<span class='headerLineTitle'>Subject:</span><span class='headerLineText'>{0}</span><br/>");
opt.FormatTemplates.Add(MhtTemplateName.Task.ActualWork, "<span class='headerLineTitle'>Actual Work:</span><span class='headerLineText'>{0}</span><br/>");
opt.FormatTemplates.Add(MhtTemplateName.Task.TotalWork, "<span class='headerLineTitle'>Total Work:</span><span class='headerLineText'>{0}</span><br/>");
opt.FormatTemplates.Add(MhtTemplateName.Task.Status, "<span class='headerLineTitle'>Status:</span><span class='headerLineText'>{0}</span><br/>");
opt.FormatTemplates.Add(MhtTemplateName.Task.Owner, "<span class='headerLineTitle'>Owner:</span><span class='headerLineText'>{0}</span><br/>");
opt.FormatTemplates.Add(MhtTemplateName.Task.Priority, "<span class='headerLineTitle'>Priority:</span><span class='headerLineText'>{0}</span><br/>");
```

### คุณสมบัติที่ 3: บันทึกข้อความ MAPI เป็นไฟล์ MHTML

#### ภาพรวม
เมื่อกำหนดค่าเสร็จแล้ว ให้บันทึกข้อความ MAPI ที่โหลดลงในไฟล์ MHTML ขั้นตอนนี้จะทำให้กระบวนการแปลงเสร็จสมบูรณ์โดยใช้ตัวเลือกที่ตั้งค่าไว้ก่อนหน้านี้

#### ขั้นตอนการดำเนินการ
**ขั้นตอนที่ 1**: กำหนดเส้นทางไฟล์เอาท์พุต
ระบุตำแหน่งที่คุณต้องการบันทึกไฟล์ MHTML ที่แปลงแล้ว
```csharp
string outputFile = dataDir + "MapiTask_out.mht";
```
**ขั้นตอนที่ 2**บันทึกข้อความ
ใช้ `Save()` วิธีการพร้อมตัวเลือกที่คุณกำหนดค่าเพื่อแปลงและจัดเก็บข้อความในรูปแบบ MHTML
```csharp
// บันทึกข้อความไปยังไฟล์ MHT โดยใช้ตัวเลือกที่กำหนดค่าไว้ก่อนหน้านี้
dynamic msg.Save(outputFile, opt);
```

## การประยุกต์ใช้งานจริง
1. **การเก็บถาวรอีเมล์**:เก็บถาวรอีเมลจากระบบเดิมโดยแปลงเป็นรูปแบบ MHTML ที่เป็นมิตรต่อเว็บ
2. **การบูรณาการกับระบบการจัดการงาน**:แปลงข้อความ MAPI ที่เกี่ยวข้องกับงานเพื่อใช้ในแอปพลิเคชันการจัดการโครงการสมัยใหม่ที่รองรับรูปแบบ HTML
3. **การจัดทำเอกสารและการแบ่งปัน**:สร้างรายงานงานอีเมลที่แชร์ได้ในรูปแบบที่เข้าถึงได้ เหมาะสำหรับการจัดทำเอกสารหรือการทำงานร่วมกัน

## การพิจารณาประสิทธิภาพ
### การเพิ่มประสิทธิภาพการทำงาน
- โหลดเฉพาะไฟล์ที่จำเป็นเพื่อลดการใช้หน่วยความจำ
- ใช้การทำงานแบบอะซิงโครนัสหากเป็นไปได้เพื่อหลีกเลี่ยงการบล็อกการทำงาน

### แนวทางการใช้ทรัพยากร
- ตรวจสอบหน่วยความจำของแอปพลิเคชันเมื่อจัดการข้อความจำนวนมาก
- กำจัดสิ่งของอย่างถูกวิธีหลังการใช้งานเพื่อประหยัดทรัพยากร

### แนวทางปฏิบัติที่ดีที่สุดสำหรับการจัดการหน่วยความจำ .NET ด้วย Aspose.Email
- ใช้ประโยชน์ `using` คำสั่งเพื่อกำจัดวัตถุโดยอัตโนมัติ
- อัปเดต Aspose.Email เป็นประจำเพื่อใช้ประโยชน์จากการปรับปรุงและเพิ่มประสิทธิภาพในเวอร์ชันใหม่กว่า

## บทสรุป
ในบทช่วยสอนนี้ คุณจะได้เรียนรู้วิธีโหลดข้อความ MAPI จากไฟล์และบันทึกเป็น MHTML โดยใช้ Aspose.Email สำหรับ .NET ตอนนี้ คุณก็มีความรู้ในการนำคุณลักษณะเหล่านี้ไปใช้ในแอปพลิเคชันของคุณแล้ว ซึ่งจะช่วยเพิ่มความสามารถในการจัดการอีเมล

**ขั้นตอนต่อไป:**
- ทดลองด้วยวิธีที่แตกต่างกัน `MhtSaveOptions` การตั้งค่า.
- สำรวจฟังก์ชันเพิ่มเติมที่จัดทำโดย Aspose.Email สำหรับ .NET

## ส่วนคำถามที่พบบ่อย
1. **ฉันสามารถใช้ Aspose.Email ได้ฟรีหรือไม่?**
   - ใช่ คุณสามารถเริ่มต้นด้วยใบอนุญาตทดลองใช้งานฟรี 30 วันเพื่อทดสอบความสามารถทั้งหมดโดยไม่มีข้อจำกัด
2. **Aspose.Email รองรับรูปแบบใดบ้างนอกเหนือจาก MAPI และ MHTML?**
   - รองรับรูปแบบอีเมลต่างๆ รวมถึง EML, MSG, PST และอื่นๆ
3. **ฉันจะจัดการไฟล์ขนาดใหญ่ใน Aspose.Email ได้อย่างไร**
   - ใช้เทคนิคการใช้หน่วยความจำอย่างมีประสิทธิภาพ เช่น การสตรีมเพื่อการอ่าน/เขียนไฟล์ขนาดใหญ่
4. **ฉันสามารถรวมฟีเจอร์นี้เข้ากับแอปพลิเคชันเว็บได้หรือไม่**
   - แน่นอน! ฟังก์ชันนี้เหมาะสำหรับแอปพลิเคชันเว็บที่ต้องการคุณสมบัติการจัดการอีเมล

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}