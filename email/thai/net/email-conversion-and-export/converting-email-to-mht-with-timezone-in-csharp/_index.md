---
title: การแปลงอีเมลเป็น MHT ด้วยเขตเวลาใน C #
linktitle: การแปลงอีเมลเป็น MHT ด้วยเขตเวลาใน C #
second_title: Aspose.Email .NET API การประมวลผลอีเมล
description: แปลงอีเมลเป็นรูปแบบ MHT ด้วยเขตเวลาที่แม่นยำโดยใช้ Aspose.Email สำหรับ .NET มีคำแนะนำทีละขั้นตอนและตัวอย่างโค้ดที่ให้ไว้
weight: 12
url: /th/net/email-conversion-and-export/converting-email-to-mht-with-timezone-in-csharp/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# การแปลงอีเมลเป็น MHT ด้วยเขตเวลาใน C


## ข้อมูลเบื้องต้นเกี่ยวกับการแปลงอีเมลเป็นอีเมลเป็น MHT พร้อมเขตเวลา

การแปลงข้อความอีเมลเป็นรูปแบบต่างๆ ถือเป็นข้อกำหนดทั่วไปในหลายๆ แอปพลิเคชัน ในสถานการณ์ที่ข้อมูลเวลาและเขตเวลามีบทบาทสำคัญ สิ่งสำคัญคือต้องแน่ใจว่าข้อมูลนี้ได้รับการเก็บรักษาอย่างถูกต้องในระหว่างกระบวนการแปลง ในคู่มือนี้ เราจะเน้นที่การแปลงอีเมลเป็นรูปแบบ MHT พร้อมกับจัดการข้อมูลเขตเวลาอย่างถูกต้อง

## การตั้งค่าสภาพแวดล้อมการพัฒนาของคุณ

ก่อนที่เราจะเจาะลึกกระบวนการเขียนโค้ด เรามาตรวจสอบให้แน่ใจว่าสภาพแวดล้อมการพัฒนาของคุณพร้อมสำหรับการดำเนินการแล้ว ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio เวอร์ชันที่เข้ากันได้ และสร้างโครงการ C# ใหม่เพื่อเริ่มต้น

## การติดตั้ง Aspose.Email สำหรับ .NET

Aspose.Email สำหรับ .NET เป็นไลบรารีที่มีฟีเจอร์มากมายซึ่งช่วยให้งานที่เกี่ยวข้องกับอีเมลง่ายขึ้น หากต้องการติดตั้ง ให้ทำตามขั้นตอนเหล่านี้:

1. เปิดโครงการของคุณใน Visual Studio
2. ไปที่ "เครื่องมือ" > "ตัวจัดการแพ็คเกจ NuGet" > "จัดการแพ็คเกจ NuGet สำหรับโซลูชัน"
3. ค้นหา "Aspose.Email" และติดตั้งแพ็คเกจ

## กำลังโหลดและแยกวิเคราะห์ข้อความอีเมล

ในขั้นตอนนี้ เราจะโหลดและแยกวิเคราะห์ข้อความอีเมลที่เราต้องการแปลง ใช้ข้อมูลโค้ดต่อไปนี้เป็นจุดเริ่มต้น:

```csharp
// เพิ่มที่จำเป็นโดยใช้คำสั่ง
using Aspose.Email;

// โหลดข้อความอีเมล
var message = MailMessage.Load("path/to/your/email.eml");

// ตอนนี้คุณสามารถเข้าถึงคุณสมบัติข้อความได้แล้ว
var subject = message.Subject;
var sender = message.From.Address;
// ...คุณสมบัติอื่นๆ
```

## การจัดการข้อมูลเขตเวลา

การจัดการกับข้อมูลเขตเวลาอย่างถูกต้องถือเป็นสิ่งสำคัญ ข้อมูลโค้ดต่อไปนี้สาธิตวิธีแยกและจัดการข้อมูลเขตเวลาจากข้อความอีเมล:

```csharp
var timezone = message.TimezoneOffset;
var timezoneId = Timezone.GetIdFromOffset(timezone);
var timezoneInfo = TimeZoneInfo.FindSystemTimeZoneById(timezoneId);
// ตอนนี้คุณสามารถใช้ timezoneInfo เพื่อจัดการการแปลงเขตเวลาได้แล้ว
```

## การแปลงอีเมลเป็นรูปแบบ MHT

มาถึงขั้นตอนการแปลงหลักแล้ว เราจะใช้ Aspose.Email เพื่อทำการแปลงเป็นรูปแบบ MHT:

```csharp
var mhtOptions = MhtSaveOptions.DefaultMhtml;
var mhtStream = new MemoryStream();
message.Save(mhtStream, mhtOptions);
```

## กำลังบันทึกไฟล์ MHT

เมื่อข้อความอีเมลแปลงเป็นรูปแบบ MHT ก็ถึงเวลาบันทึกเป็นไฟล์:

```csharp
using var fileStream = new FileStream("output.mht", FileMode.Create);
mhtStream.Seek(0, SeekOrigin.Begin);
mhtStream.CopyTo(fileStream);
```

## สำรวจการปรับแต่งเพิ่มเติม

Aspose.Email สำหรับ .NET มีตัวเลือกการปรับแต่งที่หลากหลาย คุณสามารถสำรวจการเพิ่มไฟล์แนบ การแก้ไขคุณสมบัติข้อความ และอื่นๆ อีกมากมายเพื่อให้เหมาะกับความต้องการของแอปพลิเคชันของคุณ

## ประโยชน์ของการใช้ Aspose.Email สำหรับ .NET

Aspose.Email สำหรับ .NET ลดความซับซ้อนของงานที่เกี่ยวข้องกับอีเมล ช่วยให้นักพัฒนามุ่งเน้นไปที่ฟังก์ชันการทำงานหลักได้ ให้การสนับสนุนรูปแบบอีเมลที่หลากหลาย ทำให้มั่นใจได้ถึงการแปลงที่แม่นยำและมีประสิทธิภาพ

## บทสรุป

ในคู่มือนี้ เราได้เรียนรู้วิธีแปลงข้อความอีเมลเป็นรูปแบบ MHT ในขณะที่จัดการข้อมูลเขตเวลาโดยใช้ Aspose.Email สำหรับ .NET ด้วยการทำตามขั้นตอนเหล่านี้และสำรวจตัวเลือกการปรับแต่งเพิ่มเติม คุณสามารถรวมฟังก์ชันการแปลงอีเมลเข้ากับแอปพลิเคชันของคุณได้อย่างราบรื่น

## คำถามที่พบบ่อย

### ฉันจะจัดการไฟล์แนบระหว่างการแปลงอีเมลได้อย่างไร

 ในการจัดการไฟล์แนบ คุณสามารถใช้ไฟล์`Attachments` ทรัพย์สินของ`MailMessage` ระดับ. วนซ้ำไฟล์แนบและบันทึกตามความจำเป็นในระหว่างกระบวนการแปลง

### ฉันสามารถแปลงอีเมลเป็นรูปแบบอื่นโดยใช้ Aspose.Email สำหรับ .NET ได้หรือไม่

ใช่ Aspose.Email สำหรับ .NET รองรับรูปแบบต่างๆ รวมถึง MSG, EML, PST และอื่นๆ คุณสามารถปรับตัวอย่างโค้ดที่ให้มาเพื่อให้เหมาะกับรูปแบบเอาต์พุตที่คุณต้องการ

### ข้อมูลเขตเวลาถูกเก็บรักษาไว้ในรูปแบบ MHT หรือไม่

 ใช่ ข้อมูลเขตเวลาจะถูกเก็บรักษาไว้ในระหว่างกระบวนการแปลง โดยการจัดการการชดเชยเขตเวลาและใช้อย่างเหมาะสม`TimeZoneInfo` คุณสามารถรับประกันการแสดงเขตเวลาที่แม่นยำในไฟล์ MHT

### ฉันจะหาเอกสารและการอัปเดตเพิ่มเติมเกี่ยวกับ Aspose.Email สำหรับ .NET ได้ที่ไหน

 คุณสามารถดูเอกสารประกอบสำหรับข้อมูลที่ครอบคลุมและการอัปเดต:[Aspose.Email สำหรับการอ้างอิง .NET API](https://reference.aspose.com/email/net/)

### ฉันจะดาวน์โหลด Aspose.Email สำหรับ .NET เวอร์ชันล่าสุดได้อย่างไร

 คุณสามารถดาวน์โหลดเวอร์ชันล่าสุดได้จากหน้าเผยแพร่:[ดาวน์โหลด Aspose.Email สำหรับ .NET](https://releases.aspose.com/email/net/)
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
