---
"description": "แปลงอีเมลเป็นรูปแบบ MHT ที่มีเขตเวลาที่แม่นยำโดยใช้ Aspose.Email สำหรับ .NET มีคำแนะนำทีละขั้นตอนและตัวอย่างโค้ดให้"
"linktitle": "การแปลงอีเมลเป็น MHT ด้วยโซนเวลาใน C#"
"second_title": "API การประมวลผลอีเมล Aspose.Email .NET"
"title": "การแปลงอีเมลเป็น MHT ด้วยโซนเวลาใน C#"
"url": "/th/net/email-conversion-and-export/converting-email-to-mht-with-timezone-in-csharp/"
"weight": 12
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# การแปลงอีเมลเป็น MHT ด้วยโซนเวลาใน C#


## บทนำสู่การแปลงอีเมล อีเมลไปยัง MHT พร้อมโซนเวลา

การแปลงข้อความอีเมลเป็นรูปแบบต่างๆ เป็นข้อกำหนดทั่วไปในแอปพลิเคชันจำนวนมาก ในสถานการณ์ที่ข้อมูลเวลาและโซนเวลามีบทบาทสำคัญ สิ่งสำคัญคือต้องแน่ใจว่าข้อมูลนี้ได้รับการเก็บรักษาไว้อย่างถูกต้องในระหว่างกระบวนการแปลง ในคู่มือนี้ เราจะเน้นที่การแปลงอีเมลเป็นรูปแบบ MHT ในขณะที่จัดการข้อมูลโซนเวลาอย่างถูกต้อง

## การตั้งค่าสภาพแวดล้อมการพัฒนาของคุณ

ก่อนที่เราจะเจาะลึกลงไปในกระบวนการเขียนโค้ด เรามาตรวจสอบให้แน่ใจก่อนว่าสภาพแวดล้อมการพัฒนาของคุณพร้อมสำหรับการดำเนินการแล้ว ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Visual Studio เวอร์ชันที่เข้ากันได้ และสร้างโปรเจ็กต์ C# ใหม่เพื่อเริ่มต้น

## การติดตั้ง Aspose.Email สำหรับ .NET

Aspose.Email สำหรับ .NET เป็นไลบรารีที่อุดมด้วยคุณสมบัติซึ่งช่วยลดความยุ่งยากของงานที่เกี่ยวข้องกับอีเมล หากต้องการติดตั้ง ให้ทำตามขั้นตอนเหล่านี้:

1. เปิดโปรเจ็กต์ของคุณใน Visual Studio
2. ไปที่ "เครื่องมือ" > "ตัวจัดการแพ็กเกจ NuGet" > "จัดการแพ็กเกจ NuGet สำหรับโซลูชัน"
3. ค้นหา "Aspose.Email" และติดตั้งแพ็คเกจ

## การโหลดและการแยกวิเคราะห์ข้อความอีเมล์

ในขั้นตอนนี้ เราจะโหลดและแยกข้อความอีเมลที่เราต้องการแปลง ใช้โค้ดสั้นๆ ต่อไปนี้เพื่อเป็นจุดเริ่มต้น:

```csharp
// เพิ่มคำสั่งที่จำเป็นในการใช้งาน
using Aspose.Email;

// โหลดข้อความอีเมล์
var message = MailMessage.Load("path/to/your/email.eml");

// ตอนนี้คุณมีสิทธิ์เข้าถึงคุณสมบัติของข้อความแล้ว
var subject = message.Subject;
var sender = message.From.Address;
// ...คุณสมบัติอื่น ๆ
```

## การจัดการข้อมูลโซนเวลา

การจัดการข้อมูลโซนเวลาอย่างถูกต้องถือเป็นสิ่งสำคัญ โค้ดตัวอย่างต่อไปนี้จะสาธิตวิธีการดึงและจัดการข้อมูลโซนเวลาจากข้อความอีเมล:

```csharp
var timezone = message.TimezoneOffset;
var timezoneId = Timezone.GetIdFromOffset(timezone);
var timezoneInfo = TimeZoneInfo.FindSystemTimeZoneById(timezoneId);
// ตอนนี้คุณสามารถใช้ timezoneInfo เพื่อจัดการการแปลงเขตเวลาได้แล้ว
```

## การแปลงอีเมลเป็นรูปแบบ MHT

ตอนนี้มาถึงขั้นตอนการแปลงหลักแล้ว เราจะใช้ Aspose.Email เพื่อดำเนินการแปลงเป็นรูปแบบ MHT:

```csharp
var mhtOptions = MhtSaveOptions.DefaultMhtml;
var mhtStream = new MemoryStream();
message.Save(mhtStream, mhtOptions);
```

## การบันทึกไฟล์ MHT

เมื่อข้อความอีเมลถูกแปลงเป็นรูปแบบ MHT แล้ว ถึงเวลาที่จะบันทึกเป็นไฟล์:

```csharp
using var fileStream = new FileStream("output.mht", FileMode.Create);
mhtStream.Seek(0, SeekOrigin.Begin);
mhtStream.CopyTo(fileStream);
```

## การสำรวจการปรับแต่งเพิ่มเติม

Aspose.Email สำหรับ .NET มีตัวเลือกการปรับแต่งต่างๆ มากมาย คุณสามารถลองเพิ่มไฟล์แนบ ปรับเปลี่ยนคุณสมบัติของข้อความ และอื่นๆ เพื่อให้เหมาะกับความต้องการของแอปพลิเคชันของคุณ

## ประโยชน์ของการใช้ Aspose.Email สำหรับ .NET

Aspose.Email สำหรับ .NET ช่วยลดความซับซ้อนของงานที่เกี่ยวข้องกับอีเมล ช่วยให้นักพัฒนาสามารถมุ่งเน้นไปที่ฟังก์ชันหลักได้ นอกจากนี้ยังรองรับรูปแบบอีเมลต่างๆ ได้อย่างแข็งแกร่ง ช่วยให้มั่นใจได้ว่าการแปลงอีเมลจะแม่นยำและมีประสิทธิภาพ

## บทสรุป

ในคู่มือนี้ เราได้เรียนรู้วิธีการแปลงข้อความอีเมลเป็นรูปแบบ MHT ขณะจัดการข้อมูลโซนเวลาโดยใช้ Aspose.Email สำหรับ .NET เมื่อทำตามขั้นตอนเหล่านี้และสำรวจตัวเลือกการปรับแต่งเพิ่มเติม คุณสามารถผสานฟังก์ชันการแปลงอีเมลเข้ากับแอปพลิเคชันของคุณได้อย่างราบรื่น

## คำถามที่พบบ่อย

### ฉันจะจัดการไฟล์แนบในระหว่างการแปลงอีเมลได้อย่างไร

ในการจัดการสิ่งที่แนบมา คุณสามารถใช้ `Attachments` ทรัพย์สินของ `MailMessage` คลาส ทำซ้ำผ่านสิ่งที่แนบมาและบันทึกไว้ตามต้องการในระหว่างกระบวนการแปลง

### ฉันสามารถแปลงอีเมลเป็นรูปแบบอื่นโดยใช้ Aspose.Email สำหรับ .NET ได้หรือไม่

ใช่ Aspose.Email สำหรับ .NET รองรับรูปแบบต่างๆ เช่น MSG, EML, PST และอื่นๆ คุณสามารถปรับแต่งตัวอย่างโค้ดที่ให้มาเพื่อให้เหมาะกับรูปแบบผลลัพธ์ที่คุณต้องการได้

### ข้อมูลโซนเวลาจะถูกเก็บรักษาในรูปแบบ MHT หรือไม่?

ใช่ ข้อมูลโซนเวลาจะถูกเก็บรักษาไว้ระหว่างกระบวนการแปลง โดยการจัดการการชดเชยโซนเวลาและใช้ข้อมูลที่เหมาะสม `TimeZoneInfo` วิธีการนี้ช่วยให้คุณสามารถมั่นใจได้ถึงการแสดงโซนเวลาที่ถูกต้องในไฟล์ MHT

### ฉันสามารถหาเอกสารเพิ่มเติมและอัพเดตเกี่ยวกับ Aspose.Email สำหรับ .NET ได้จากที่ใด

คุณสามารถดูข้อมูลโดยละเอียดและการอัปเดตได้ในเอกสารประกอบ: [เอกสารอ้างอิง API ของ Aspose.Email สำหรับ .NET](https://reference.aspose.com/email/net/)

### ฉันจะดาวน์โหลด Aspose.Email สำหรับ .NET เวอร์ชันล่าสุดได้อย่างไร

คุณสามารถดาวน์โหลดเวอร์ชันล่าสุดได้จากหน้าเผยแพร่: [ดาวน์โหลด Aspose.Email สำหรับ .NET](https://releases.aspose.com/email/net/)

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}