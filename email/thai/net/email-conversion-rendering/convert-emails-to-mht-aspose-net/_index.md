---
"date": "2025-05-29"
"description": "เรียนรู้วิธีการแปลงอีเมลเป็นไฟล์ MHT โดยใช้ Aspose.Email สำหรับ .NET พร้อมการตั้งค่าที่กำหนดเองได้ รวมถึงการยกเว้นภาพอินไลน์ตามตัวเลือก"
"title": "แปลงอีเมลเป็นไฟล์ MHT โดยใช้ Aspose.Email .NET คู่มือฉบับสมบูรณ์"
"url": "/th/net/email-conversion-rendering/convert-emails-to-mht-aspose-net/"
"weight": 1
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}
# แปลงอีเมลเป็นไฟล์ MHT โดยใช้ Aspose.Email .NET: คู่มือฉบับสมบูรณ์

หมวดหมู่บทช่วยสอน: การแปลงและการแสดงผลอีเมล
URL SEO ปัจจุบัน: convert-emails-to-mht-aspose-net

## วิธีการแปลงอีเมลเป็นไฟล์ MHT ด้วยการตั้งค่าที่กำหนดเองได้ใน Aspose.Email สำหรับ .NET

คุณกำลังมองหาวิธีบันทึกข้อความอีเมลของคุณเป็นไฟล์ MHT โดยยังคงรูปแบบและเนื้อหาเอาไว้หรือไม่ บทช่วยสอนนี้จะแนะนำคุณเกี่ยวกับการใช้ Aspose.Email สำหรับ .NET ซึ่งมีการตั้งค่าที่ปรับแต่งได้ เช่น การยกเว้นรูปภาพอินไลน์ ปฏิบัติตามคำแนะนำทีละขั้นตอนนี้เพื่อนำคุณลักษณะเหล่านี้ไปใช้ได้อย่างมีประสิทธิภาพ

## สิ่งที่คุณจะได้เรียนรู้

- วิธีตั้งค่า Aspose.Email สำหรับ .NET ในโครงการของคุณ
- แปลงอีเมลเป็นไฟล์ MHT ด้วยการตั้งค่าการจัดรูปแบบที่เป็นทางเลือก
- บันทึกอีเมลเป็น MHT โดยไม่รวมรูปภาพอินไลน์
- แก้ไขปัญหาทั่วไประหว่างการใช้งาน

เริ่มต้นด้วยการตั้งค่าเครื่องมือและไลบรารีที่จำเป็น

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเริ่มบทช่วยสอนนี้ ให้แน่ใจว่าคุณมี:

- Aspose.Email สำหรับไลบรารี .NET ที่ติดตั้งในโครงการของคุณ
- ความเข้าใจพื้นฐานเกี่ยวกับการเขียนโปรแกรม C#
- Visual Studio หรือ IDE ที่เข้ากันได้อื่น ๆ ที่ติดตั้งบนเครื่องของคุณ

## การตั้งค่า Aspose.Email สำหรับ .NET

### การติดตั้ง

ในการเริ่มใช้ Aspose.Email สำหรับ .NET ให้ติดตั้งแพ็คเกจโดยใช้หนึ่งในวิธีต่อไปนี้:

**.NET CLI**
```bash
dotnet add package Aspose.Email
```

**ตัวจัดการแพ็คเกจ**
```powershell
Install-Package Aspose.Email
```

**UI ตัวจัดการแพ็กเกจ NuGet**
- ค้นหา "Aspose.Email" และติดตั้งเวอร์ชันล่าสุด

### การขอใบอนุญาต

คุณสามารถรับใบอนุญาตทดลองใช้งานฟรีเพื่อสำรวจฟีเจอร์ทั้งหมดโดยไม่มีข้อจำกัด เยี่ยมชม [ลิงค์นี้](https://releases.aspose.com/email/net/) เพื่อดาวน์โหลดใบอนุญาตชั่วคราวหรือพิจารณาซื้อใบอนุญาตเต็มรูปแบบหากคุณพบว่าเหมาะกับความต้องการของคุณ

เริ่มต้น Aspose.Email ในโครงการของคุณโดยกำหนดค่าใบอนุญาตดังนี้:
```csharp
Aspose.Email.License license = new Aspose.Email.License();
license.SetLicense("Aspose.Total.lic");
```

## คู่มือการใช้งาน

เราจะแบ่งกระบวนการออกเป็นสองคุณลักษณะหลัก: การบันทึกอีเมลโดยมีการตั้งค่าเพิ่มเติม และการยกเว้นรูปภาพอินไลน์

### บันทึก MHTML ด้วยการตั้งค่าเสริม

คุณสมบัตินี้ช่วยให้คุณสามารถบันทึกข้อความอีเมล์เป็นไฟล์ MHT ได้ในขณะที่ระบุตัวเลือกการจัดรูปแบบ

#### ภาพรวม

คุณสามารถปรับแต่งวิธีบันทึกอีเมลของคุณได้โดยรวมข้อมูลส่วนหัว ตรวจสอบการเข้ารหัสเนื้อหา และแสดงส่วนหัวดั้งเดิม

#### ขั้นตอนการดำเนินการ

1. **ตั้งค่าเส้นทางไฟล์**
   
   กำหนดเส้นทางไดเร็กทอรีสำหรับการอ่านอีเมลอินพุตและบันทึกไฟล์ MHT เอาท์พุต
   ```csharp
   string dataDir = Path.Combine("YOUR_DOCUMENT_DIRECTORY", "Email");
   ```

2. **โหลดข้อความอีเมล์**

   ใช้ `MailMessage.Load` เพื่ออ่านอีเมล์จากไฟล์
   ```csharp
   MailMessage eml = MailMessage.Load(Path.Combine(dataDir, "Message.eml"));
   ```

3. **กำหนดค่าตัวเลือกการบันทึก MHT**

   ตั้งค่า `MhtSaveOptions` พร้อมตัวเลือกการจัดรูปแบบตามต้องการ
   ```csharp
   MhtSaveOptions mhtSaveOptions = new MhtSaveOptions
   {
       MhtFormatOptions = MhtFormatOptions.WriteHeader | MhtFormatOptions.HideExtraPrintHeader | MhtFormatOptions.DisplayAsOutlook,
       CheckBodyContentEncoding = true
   };
   ```

4. **บันทึกอีเมลเป็นไฟล์ MHT**

   ใช้ `Save` วิธีการเขียนเนื้อหาอีเมล์พร้อมตัวเลือกที่ระบุ
   ```csharp
   eml.Save(Path.Combine("YOUR_OUTPUT_DIRECTORY", "outMessage_out.mht"), mhtSaveOptions);
   ```

### แปลงเป็น MHTML โดยไม่ต้องมีภาพอินไลน์

ฟีเจอร์นี้สาธิตการบันทึกอีเมลเป็นไฟล์ MHT โดยข้ามภาพอินไลน์

#### ภาพรวม

โดยการตั้งค่า `SkipInlineImages` เป็นจริง คุณสามารถบันทึกเนื้อหาอีเมลได้โดยไม่ต้องฝังรูปภาพใด ๆ ลงในไฟล์โดยตรง

#### ขั้นตอนการดำเนินการ

1. **ตั้งค่าเส้นทางไฟล์**
   
   เช่นเดียวกับก่อนหน้านี้ ให้กำหนดไดเร็กทอรีอินพุตและเอาต์พุตของคุณ
   ```csharp
   string dataDir = Path.Combine("YOUR_DOCUMENT_DIRECTORY", "Email");
   ```

2. **โหลดข้อความอีเมล์**

   โหลดอีเมล์ที่คุณต้องการแปลง
   ```csharp
   MailMessage eml = MailMessage.Load(Path.Combine(dataDir, "Message.eml"));
   ```

3. **กำหนดค่าตัวเลือกการบันทึก MHT**

   ชุด `SkipInlineImages` เป็นจริงในการกำหนดค่าตัวเลือกของคุณ
   ```csharp
   MhtSaveOptions mhtSaveOptions = new MhtSaveOptions
   {
       SkipInlineImages = true
   };
   ```

4. **บันทึกอีเมลเป็นไฟล์ MHT**

   สุดท้ายให้บันทึกอีเมล์โดยไม่ต้องมีรูปภาพอินไลน์
   ```csharp
   eml.Save(Path.Combine("YOUR_OUTPUT_DIRECTORY", "EmlToMhtmlWithoutInlineImages_out.mht"), mhtSaveOptions);
   ```

### เคล็ดลับการแก้ไขปัญหา

- ตรวจสอบให้แน่ใจว่าเส้นทางไฟล์ของคุณถูกต้องเพื่อหลีกเลี่ยง `FileNotFoundException`-
- ตรวจสอบอีกครั้งว่า Aspose.Email ได้รับอนุญาตถูกต้องหากคุณพบข้อจำกัดเกี่ยวกับคุณสมบัติ

## การประยุกต์ใช้งานจริง

คุณสมบัติเหล่านี้สามารถใช้ได้ในสถานการณ์ต่างๆ เช่น:

1. **การเก็บถาวรอีเมล์**:เก็บรักษาการสนทนาทางอีเมล์ในรูปแบบคงที่เพื่อการจัดเก็บในระยะยาว
2. **การวิเคราะห์เนื้อหาอีเมล**:แยกและวิเคราะห์เนื้อหาอีเมลโดยไม่มีรูปภาพเพื่อการประมวลผลที่รวดเร็วยิ่งขึ้น
3. **การบูรณาการกับระบบการจัดการเอกสาร**:ทำให้การแปลงอีเมล์เป็นรูปแบบเอกสารที่เข้ากันได้กับระบบที่มีอยู่ของคุณเป็นแบบอัตโนมัติ

## การพิจารณาประสิทธิภาพ

เพื่อเพิ่มประสิทธิภาพการทำงาน:

- ลดการใช้หน่วยความจำโดยกำจัดวัตถุอย่างถูกต้องหลังใช้งาน
- ใช้หลักการจัดการที่มีประสิทธิภาพของ Aspose.Email เพื่อจัดการชุดข้อมูลอีเมลขนาดใหญ่

## บทสรุป

ตอนนี้คุณได้เรียนรู้วิธีการแปลงอีเมลเป็นไฟล์ MHT โดยใช้ Aspose.Email สำหรับ .NET แล้ว ทั้งแบบมีการตั้งค่าเสริมและไม่มีรูปภาพอินไลน์ ความยืดหยุ่นนี้ช่วยให้คุณปรับแต่งผลลัพธ์ให้เหมาะกับความต้องการเฉพาะของคุณได้

ขั้นตอนต่อไป ได้แก่ การทดลองใช้ฟีเจอร์อื่นๆ ที่ Aspose.Email จัดทำไว้ หรือการรวมฟังก์ชันนี้เข้ากับโปรเจ็กต์ขนาดใหญ่

## ส่วนคำถามที่พบบ่อย

**ถาม: ฉันจะมั่นใจได้อย่างไรว่าไฟล์อีเมลของฉันถูกแปลงอย่างถูกต้อง**
ก: ตรวจสอบเส้นทางไฟล์ ตรวจสอบใบอนุญาตที่ถูกต้อง และตรวจสอบว่า `MhtSaveOptions` การตั้งค่าให้ตรงตามความต้องการของคุณ

**ถาม: ฉันสามารถใช้ Aspose.Email โดยไม่ต้องมีใบอนุญาตได้หรือไม่**
A: ใช่ คุณสามารถใช้งานด้วยใบอนุญาตทดลองใช้งานฟรีซึ่งให้สิทธิ์เข้าถึงฟีเจอร์ทั้งหมดชั่วคราว

**ถาม: จะเกิดอะไรขึ้นหากการแปลงอีเมล์ของฉันล้มเหลว?**
ก. ตรวจสอบข้อผิดพลาดในเส้นทางไฟล์หรือปัญหาด้านลิขสิทธิ์ ตรวจสอบ `MhtSaveOptions` การตั้งค่าด้วยเช่นกัน

**ถาม: Aspose.Email เข้ากันได้กับเวอร์ชัน .NET เก่าๆ ได้หรือไม่**
A: ยืนยันความเข้ากันได้โดยการตรวจสอบ [เอกสารประกอบของ Aspose](https://reference-aspose.com/email/net/).

**ถาม: ฉันจะลบส่วนหัวออกจากไฟล์ MHT ที่บันทึกได้อย่างไร**
ก. ปรับแต่ง `MhtFormatOptions` เพื่อยกเว้นส่วนหัวตามความจำเป็น

## ทรัพยากร

- **เอกสารประกอบ**- [เอกสารประกอบ Aspose.Email .NET](https://reference.aspose.com/email/net/)
- **ดาวน์โหลด**- [การเปิดตัวล่าสุด](https://releases.aspose.com/email/net/)
- **ซื้อ**- [ซื้อ Aspose.อีเมล](https://purchase.aspose.com/buy)
- **ทดลองใช้งานฟรี**- [ใบอนุญาตชั่วคราว](https://releases.aspose.com/email/net/)
- **สนับสนุน**- [ฟอรั่มอีเมล์ Aspose](https://forum.aspose.com/c/email/10)

ทดลองใช้ฟีเจอร์เหล่านี้และดูว่าฟีเจอร์เหล่านี้จะช่วยปรับปรุงกระบวนการจัดการอีเมลของคุณได้อย่างไร ขอให้สนุกกับการเขียนโค้ด!

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}